# Example Configuration with Preprocessor Query Support
# This demonstrates how to use config_query_key for dynamic dataset replacement

# Local Development Example (MYLOCAL)
config_block_local_preprocessor:
  source:
    database_type: gcpbq
    gcp:
      project_id: my-gcp-project
      dataset_id: source_dataset
      credentials_path: /path/to/credentials.json
      location: us-central1

    # Optional: Specify a preprocessor query to get dynamic dataset names
    config_query_key: "get_bcbsa_releases"
    source_name: "bcbsa"

  target:
    database_type: gcpbq
    gcp:
      project_id: my-gcp-project
      dataset_id: target_dataset
      credentials_path: /path/to/credentials.json
      location: us-central1

    config_query_key: "get_bcbsa_releases"
    source_name: "bcbsa"

  other:
    validation_script: test_script.yml
    preprocessor_queries: preprocessor_queries.yml

# Kubernetes Example (gcpqa|gcppreprod|gcpprod) - MySQL to BigQuery
config_block_k8_mysql_to_bq:
  source:
    database_type: mysql
    mysql:
      k8_db_details: project_ventana  # Format: project_name_database_name

  target:
    database_type: gcpbq
    gcp:
      k8_db_details: project_bcbsa_target  # Format: project_name_dataset_name
      location: us-central1

  other:
    validation_script: test_script.yml

# Kubernetes Example (gcpqa|gcppreprod|gcpprod) - BigQuery to BigQuery with Preprocessor
config_block_k8_preprocessor:
  source:
    database_type: gcpbq
    gcp:
      k8_db_details: project_bcbsa_releases  # Format: project_name_dataset_name
      location: us-central1

    # Optional: Specify a preprocessor query to get dynamic dataset names
    config_query_key: "get_bcbsa_releases"
    source_name: "bcbsa"

  target:
    database_type: gcpbq
    gcp:
      k8_db_details: project_bcbsa_target  # Format: project_name_dataset_name
      location: us-central1

    config_query_key: "get_bcbsa_releases"
    source_name: "bcbsa"

  other:
    validation_script: test_script.yml
    preprocessor_queries: preprocessor_queries.yml
